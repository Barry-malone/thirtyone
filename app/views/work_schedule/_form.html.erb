<% @selected_person = @work_schedule.staff_id ? @people.find(@work_schedule.staff_id) : nil %>

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.1/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
<%= javascript_include_tag "ion.rangeSlider.min" %>
<%= stylesheet_link_tag "ionRangeSlider" %>
<%= stylesheet_link_tag "ionRangeSliderSkinHTML5" %>
<%= javascript_tag do %>
    window.availableTags = [
    <% @people.each do |person| %>
        { label: '<%= person.fullname %>', value: '<%= person.id %>'},
    <% end %>
    ];
    window.start_time = <%= @selected_person ? (@work_schedule.start_at.hour * 60) + @work_schedule.start_at.min : 480 %>;
    window.end_time = <%= @selected_person ? (@work_schedule.end_at.hour * 60) + @work_schedule.end_at.min : 960 %>;
<% end %>

<%= form_for(@work_schedule) do |f| %>
    <div class="field">
      <%= f.label :Staff %> <br>

      <div class="ui-widget" id="person_div">
        <input id="person" value="<%= @selected_person ? @selected_person.fullname : nil %>"><br/>
        <input name="person_id" id="person_id" value="<%= @selected_person ? @work_schedule.staff_id : nil %>" type="hidden"/>
        <span id="person_error" hidden="true">Please enter valid staff name</span>
      </div>
    </div>
    <div class="field small-6 medium-4 large-2">
      <%= f.label :date %> <br>
      <input id="date" class="time-select" type="date" value="<%= @work_schedule.start_at.to_date %>">
    </div>
    <div class="field">
      <%= f.label :time %> <br/>
      <input type="text" id="time-slider"/>
      <%= f.hidden_field :start_at, {:value => @work_schedule.start_at} %>
      <%= f.hidden_field :end_at, {:value => @work_schedule.end_at} %>
    </div>
    <div class="field">
      <%= f.label :notes %> <br>
      <%= f.text_area :note, :value => @work_schedule.note %>
    </div>
    <div class="actions">
      <%= @selected_person ? button_to('Update', {:controller => :work_schedule, :action => 'update', :id => @work_schedule.id}, {:method => :post ,class: 'button tiny', id: 'submit'}) : nil %>
      <%= @selected_person ? button_to('Delete', {:controller => :work_schedule, :action => 'destroy', :id => @work_schedule.id}, {:method => :delete, :class => 'button tiny'}) : nil %>
      <%= @selected_person ? nil : submit_tag('Schedule', class: 'button tiny', id: 'submit') %>
    </div>
<% end %>