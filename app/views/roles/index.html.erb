<div class="row">
  <div class="small-12 medium-9 large-8 columns small-centered">
    <h1>Listing roles</h1>

    <div id="editRole" class="reveal-modal" data-reveal></div>

    <script>
        $('#editRole').foundation('reveal', {
            close_on_background_click: false,
            animation: 'none'
        });
    </script>

    <table>
      <thead>
      <tr>
        <th>Role Name</th>
        <th>Actions</th>
      </tr>
      </thead>

      <tbody>
      <% @roles.each do |role| %>
          <tr>
            <td><%= role.name %></td>
            <td>
              <%= link_to 'View', role %>
              <% if role.name != 'Admin' %>
                  &nbsp; &nbsp;
                  <%= link_to 'Edit', edit_role_path(role) %>
                  &nbsp; &nbsp;
                  <%
                     @role_affect_string = ''
                     role.users.each do |user|
                       if @role_affect_string.blank? then
                         @role_affect_string = ' '+ user.person.fullname
                       else
                         @role_affect_string = @role_affect_string +', '+ user.person.fullname
                       end
                     end
                     if @role_affect_string.blank? then
                       @role_affect_string = ' nobody'
                     end
                  %>
                  <%= link_to 'Destroy', role, method: :delete, data: {confirm: 'Are you sure? This affects'+ @role_affect_string +'.'}, "data-reveal-id" => "MyModal" %>
              <% end %>
            </td>
          </tr>
      <% end %>
      </tbody>

    </table>

    <br>

    <%= button_to 'New Role', new_role_path, method: 'get', :class => 'button tiny' %>
  </div>
</div>
